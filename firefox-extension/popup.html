<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PursuitPal</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
    />
    <style>
      :root {
        --primary-color: #552dec;
        --primary-light: #6b44f0;
        --primary-dark: #4425be;
      }

      body {
        width: 400px;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .btn-primary {
        background-color: var(--primary-color);
      }

      .btn-primary:hover {
        background-color: var(--primary-light);
      }

      .text-primary {
        color: var(--primary-color);
      }

      .bg-primary {
        background-color: var(--primary-color);
      }

      .border-primary {
        border-color: var(--primary-color);
      }

      .spinner {
        border: 3px solid rgba(85, 45, 236, 0.2);
        border-radius: 50%;
        border-top: 3px solid var(--primary-color);
        width: 24px;
        height: 24px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow py-4 px-6 flex items-center justify-between">
      <div class="flex items-center">
        <div class="flex-shrink-0 mr-2">
          <svg
            width="32"
            height="32"
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M16 2C8.268 2 2 8.268 2 16s6.268 14 14 14 14-6.268 14-14S23.732 2 16 2zm0 4.2c2.337 0 4.2 1.863 4.2 4.2s-1.863 4.2-4.2 4.2-4.2-1.863-4.2-4.2 1.863-4.2 4.2-4.2zm0 19.74c-3.5 0-6.65-1.75-8.4-4.55 0-2.8 5.6-4.34 8.4-4.34s8.4 1.54 8.4 4.34c-1.75 2.8-4.9 4.55-8.4 4.55z"
              fill="#552dec"
            />
          </svg>
        </div>
        <div>
          <h1 class="text-lg font-semibold text-primary">PursuitPal</h1>
          <p class="text-xs text-gray-500">Job Tracking Assistant</p>
        </div>
      </div>
      <!-- Profile Menu Toggle -->
      <div id="userProfileToggle" class="relative hidden cursor-pointer">
        <div
          class="h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-medium text-sm"
        >
          <span id="userInitials">--</span>
        </div>
      </div>
    </header>

    <!-- Login View -->
    <div id="loginView" class="p-6">
      <div class="text-center mb-6">
        <h2 class="text-xl font-bold text-gray-800">Sign In</h2>
        <p class="text-sm text-gray-600 mt-1">Use your PursuitPal account</p>
      </div>

      <form id="loginForm">
        <!-- Error message -->
        <div
          id="loginError"
          class="hidden mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded-md text-sm"
        ></div>

        <!-- Email Field -->
        <div class="mb-4">
          <label
            for="email"
            class="block text-sm font-medium text-gray-700 mb-1"
            >Email</label
          >
          <input
            type="email"
            id="email"
            name="email"
            required
            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"
            placeholder="your@email.com"
          />
        </div>

        <!-- Password Field -->
        <div class="mb-6">
          <label
            for="password"
            class="block text-sm font-medium text-gray-700 mb-1"
            >Password</label
          >
          <input
            type="password"
            id="password"
            name="password"
            required
            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"
            placeholder="••••••••"
          />
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          id="loginButton"
          class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-light focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
        >
          Sign In
        </button>

        <!-- Loading State -->
        <div id="loginLoading" class="hidden mt-4 flex justify-center">
          <div class="spinner"></div>
        </div>
      </form>

      <!-- Open App Link -->
      <div class="mt-4 text-center">
        <a
          href="https://pursuitpal.app"
          target="_blank"
          class="text-sm text-primary hover:underline"
          >Open PursuitPal App</a
        >
      </div>
    </div>

    <!-- Main View (after login) -->
    <div id="mainView" class="hidden">
      <!-- Job Data Extraction Section -->
      <div id="extractionSection" class="p-6 border-b border-gray-200">
        <!-- Not a Job Page View -->
        <div id="notJobPageView" class="hidden text-center py-4">
          <svg
            class="w-16 h-16 mx-auto text-gray-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
            ></path>
          </svg>
          <h3 class="mt-2 text-sm font-medium text-gray-900">
            Not a Job Posting Page
          </h3>
          <p class="mt-1 text-xs text-gray-500">
            Visit a job posting page to extract job details
          </p>
          <div class="mt-4">
            <a
              href="https://pursuitpal.app/applications"
              target="_blank"
              class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary hover:bg-primary-light focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
            >
              View Your Applications
            </a>
          </div>
        </div>

        <!-- Loading View -->
        <div id="loadingView" class="hidden text-center py-4">
          <div class="spinner mx-auto mb-4"></div>
          <p class="text-sm text-gray-600">Extracting job data...</p>
        </div>

        <!-- Error View -->
        <div id="errorView" class="hidden py-4">
          <div class="bg-red-50 border border-red-200 rounded-md p-4">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg
                  class="h-5 w-5 text-red-400"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                    clip-rule="evenodd"
                  />
                </svg>
              </div>
              <div class="ml-3">
                <h3 class="text-sm font-medium text-red-800">
                  Extraction Failed
                </h3>
                <p class="text-xs text-red-700 mt-1" id="errorMessage">
                  Could not extract job data from this page.
                </p>
              </div>
            </div>
          </div>
          <div class="mt-4 text-center">
            <button
              id="retryButton"
              class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
            >
              <svg
                class="-ml-0.5 mr-2 h-4 w-4"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                  clip-rule="evenodd"
                />
              </svg>
              Retry
            </button>
          </div>
        </div>

        <!-- Job Data View -->
        <div id="jobDataView" class="hidden">
          <div
            class="border border-gray-200 rounded-md overflow-hidden shadow-sm"
          >
            <div class="p-4 border-b border-gray-200 bg-gray-50">
              <h3 class="text-lg font-semibold text-gray-900" id="jobTitle">
                Job Title
              </h3>
              <div class="mt-1 flex items-center text-sm">
                <span class="font-medium text-primary" id="companyName"
                  >Company Name</span
                >
                <span class="mx-2 text-gray-500">•</span>
                <span class="text-gray-600" id="jobLocation">Location</span>
              </div>
            </div>

            <div class="px-4 py-3 bg-white">
              <div class="grid grid-cols-2 gap-2 text-sm">
                <div>
                  <span class="block text-gray-500 text-xs">Job Type</span>
                  <span class="font-medium" id="jobType">-</span>
                </div>
                <div>
                  <span class="block text-gray-500 text-xs">Salary</span>
                  <span class="font-medium" id="jobSalary">-</span>
                </div>
              </div>

              <!-- Actions -->
              <div class="mt-4 flex space-x-2">
                <button
                  id="saveJobButton"
                  class="flex-1 inline-flex items-center justify-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary hover:bg-primary-light focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
                >
                  <svg
                    class="-ml-0.5 mr-2 h-4 w-4"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                  >
                    <path
                      d="M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"
                    />
                  </svg>
                  Save to PursuitPal
                </button>

                <button
                  id="refreshJobButton"
                  class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
                >
                  <svg
                    class="h-4 w-4"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer Section -->
      <div class="p-4 flex justify-between items-center bg-gray-50">
        <div class="text-sm">
          <a
            href="https://pursuitpal.app/applications"
            target="_blank"
            class="text-primary hover:underline"
            >View All Applications</a
          >
        </div>
        <div>
          <button
            id="logoutButton"
            class="inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"
          >
            Sign Out
          </button>
        </div>
      </div>
    </div>

    <script src="popup.js" type="module"></script>
  </body>
</html>
